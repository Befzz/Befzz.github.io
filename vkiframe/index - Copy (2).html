<!DOCTYPE html>
<html>
<head>
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="icon" type="image/vnd.microsoft.icon" href="/favicon.ico" />
<link rel="stylesheet" type="text/css" href="main.css?1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>MeOkay - vkapitest</title>
<script src="main.js"></script>

<script src="//vk.com/js/api/xd_connection.js?2"  type="text/javascript"></script>

<script type="text/javascript">
VK.init(function() { 
	console.log('VKapi success')
}, function() { 
	console.log('VKapi failed')
}, '5.35'); 

function installbox() {
	//VK.callMethod("showSettingsBox",0);
	VK.callMethod("showInstallBox");
	
}
function setname() {
	VK.api('account.setNameInMenu',{user_id:144179099,name:"woop!"},function (){
		console.log(arguments);
	})
}
function setcounter() {
	VK.api('setCounter',{user_id:144179099,counter:10},function (){
		console.log(arguments);
	});
}
function getappperm() {
	VK.api('account.getAppPermissions',{user_id:144179099},function (){
		console.log(arguments);
	});
}
function make_iframe() {
	var iframe = document.createElement('iframe');
	var html = '<scr'+'ipt src="//vk.com/js/api/openapi.js" type="text/javascript"></scr'+'ipt>'+
'<scr'+'ipt type="text/javascript">\
  VK.init({\
    apiId: 3915837\
  });\
  function authInfo(response) {\
  if (response.session) {\
    console.log("user: "+response.session.mid);\
  } else {\
    console.log("not auth");\
  }\
}\
VK.Auth.getLoginStatus(authInfo);\
</scr'+'ipt><body>Foo</body>';
	iframe.style.cssText = "border: 1px solid red; width:100%;height:200px;"
	document.body.appendChild(iframe);
	iframe.contentWindow.document.open();
	iframe.contentWindow.document.write(html);
	iframe.contentWindow.document.close();
}
addEventListener('load',function(){
	make_iframe();
})
</script>
</head>
<body>
<div id="vk_api_transport"></div>

<table><tr><td id="panel-left">
<div id="login_button" onclick="installbox()">install</div>
<div id="login_button" onclick="setname()">setname</div>
<div id="login_button" onclick="setcounter()">setcounter</div>
<div id="login_button" onclick="getappperm()">getapperm</div>
<div id="login_button" onclick="VK.Auth.login(authInfo,0);">Auth! me</div>
</td><td id="panel-display"><span id="vklogin" href="">VK app req</span></td></tr></table>
</body>
</html>